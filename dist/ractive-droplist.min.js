!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.RactiveDroplist=t():e.RactiveDroplist=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(s){if(n[s])return n[s].exports;var i=n[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,s){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:s})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Ractive.extend({template:{v:4,t:[{t:7,e:"div",m:[{n:"class",f:[{t:2,r:"class"}],t:13},{n:"class-hidden",t:13,f:[{t:2,r:"fp.hidden"}]}],f:[{t:4,f:[{t:7,e:"label",m:[{t:13,n:"class",f:"oh nowrap-ellipsis",g:1}],f:[{t:4,f:[{t:7,e:"span",m:[{t:13,n:"class",f:"required",g:1}],f:["*"]}],n:50,r:"fp.required"},{t:2,r:"label"}]}],n:50,r:"label"}," ",{t:7,e:"input",m:[{n:"type",f:"text",t:13},{n:"name",f:[{t:2,r:"name"}],t:13},{n:"value",f:[{t:2,r:"value"}],t:13},{n:"class",f:"hidden-out-of-view",t:13},{n:"class-required",t:13,f:[{t:2,r:"fp.required"}]}]}," ",{t:7,e:"div",m:[{t:13,n:"class",f:"droplist btn-group",g:1},{n:"class-open",t:13,f:[{t:2,r:"menu_open"}]},{n:["actionoutside"],t:70,f:{r:["@this"],s:'[_0.set("menu_open",false)]'}}],f:[{t:7,e:"button",m:[{t:13,n:"class",f:"btn btn-default dropdown-toggle",g:1},{n:"type",f:"button",t:13,g:1},{n:"aria-haspopup",f:"true",t:13,g:1},{n:"aria-expanded",f:[{t:2,x:{r:["menu_open"],s:'_0?"true":"false"'}}],t:13},{n:["click"],t:70,f:"toggle_menu"},{t:2,x:{r:["fp.disabled"],s:'_0?"disabled":""'}}],f:[{t:7,e:"span",m:[{t:13,n:"class",f:"selected-text",g:1}],f:[{t:3,x:{r:["selected_text"],s:'_0?_0:"&nbsp;"'}}]}," ",{t:7,e:"span",m:[{t:13,n:"class",f:"caret",g:1}]}]}," ",{t:7,e:"ul",m:[{t:13,n:"class",f:"dropdown-menu js-input-container",g:1}],f:[{t:7,e:"li",m:[{t:13,n:"style",f:"padding:5px;;",g:1}],f:[{t:7,e:"input",m:[{n:"type",f:"text",t:13},{n:"class",f:"form-control",t:13},{n:"autocomplete",f:"off",t:13},{n:"value",f:[{t:2,r:"text_value"}],t:13},{n:["keydown"],t:70,f:"keydown"},{n:"placeholder",f:[{t:2,r:"type_to_search"}],t:13}]}]}]}," ",{t:7,e:"ul",m:[{t:13,n:"class",f:"dropdown-menu js-drop-list",g:1},{n:"style",f:["max-height: ",{t:2,r:"maxheight"},"px; ",{t:2,x:{r:["show_list_on_open","text_value"],s:'_0||_1?"":"height:0px;"'}}],t:13}],f:[{t:4,f:[{t:7,e:"li",m:[{n:"class-selected",t:13,f:[{t:2,x:{r:["value","~/value"],s:"_0==_1"}}]},{n:"class-active",t:13,f:[{t:2,x:{r:["value","active_value"],s:"_0==_1"}}]},{n:["click"],t:70,f:"set_selected"},{n:["mouseenter"],t:70,f:"set_active"},{n:["mouseup"],t:70,f:{r:["@this","set_active"],s:'[_0.find("input").focus(),_1]'}}],f:[{t:8,r:"content"}]}],n:52,r:"filtered"},{t:4,f:[{t:7,e:"li",f:[{t:2,x:{r:["text_value","no_results"],s:'_0?_1:""'}}]}],n:51,l:1}]}]}," ",{t:7,e:"label",m:[{t:13,n:"style",f:"display:none;;",g:1},{t:13,n:"class",f:"error",g:1},{n:"for",f:[{t:2,r:"name"}],t:13}]}]}],e:{'[_0.set("menu_open",false)]':function(e){return[e.set("menu_open",!1)]},'_0?"true":"false"':function(e){return e?"true":"false"},'_0?"disabled":""':function(e){return e?"disabled":""},'_0?_0:"&nbsp;"':function(e){return e||"&nbsp;"},'_0||_1?"":"height:0px;"':function(e,t){return e||t?"":"height:0px;"},"_0==_1":function(e,t){return e==t},'[_0.find("input").focus(),_1]':function(e,t){return[e.find("input").focus(),t]},'_0?_1:""':function(e,t){return e?t:""}}},css:"",data:function(){return{no_results:"No results",type_to_search:"Type here to search",label:"",class:"",menu_open:!1,list:[],value:"",active_value:"",text_value:"",show_list_on_open:!0,as_value:"value",as_text:"text",maxheight:210,add_search:"",fp:{required:!1,hidden:!1,disabled:!1},fp_event:null}},computed:{filtered:function(){var e=this.get("show_list_on_open"),t=this.get("text_value");return(e||!e&&t.length>0?this.get("list"):[]).reduce(function(e,n){var s={value:n[this.get("as_value")],text:n[this.get("as_text")]};if(s.add_search=n[this.get("add_search")]?n[this.get("add_search")]:"",s.text.toUpperCase().indexOf(t.toUpperCase())>=0||s.add_search.toUpperCase().indexOf(t.toUpperCase())>=0){var i=new RegExp(t,"i").exec(s.text);s.text_highlighted=null!=i?s.text.replace(i[0],"<mark>"+i[0]+"</mark>"):s.text.replace(t,"<mark>"+t+"</mark>"),e.push(s)}return e}.bind(this),[])},selected_text:function(){var e=this.get("value"),t=this.get("list"),n=t.filter(function(t){return t[this.get("as_value")]==e}.bind(this));return n.length>0?n[0][this.get("as_text")]:""},name:function(){return"dl_"+_u.uuid()}},on:{keydown:function(e){var t=e.original.keyCode;if(38===t||40===t){e.original.preventDefault();for(var n=this.get("filtered"),s=(this.get("value"),this.get("active_value")),i="",r=!1,l=0;l<n.length;l++)if(n[l].value==s){var o=38==t?-1:1;i=void 0!==n[l+o]?n[l+o].value:n[l].value,r=!0;break}var a=r?i:n.length>0?n[0].value:"";this.set("active_value",a);var u=this.find("li.active"),f=u.offsetTop,c=u.clientHeight,p=this.find(".js-drop-list");38===t&&f<p.scrollTop&&(p.scrollTop-=c),40===t&&f+c>p.offsetHeight+p.scrollTop&&f+c<=p.scrollHeight&&(p.scrollTop+=c)}13===t&&(e.original.preventDefault(),this.set({value:1==this.get("filtered").length?this.get("filtered.0.value"):this.get("active_value"),menu_open:!1}),this.fire("change",e,{selected_line:e.get()}),this.find("button.dropdown-toggle").focus())},set_selected:function(e){this.set({value:e.get("value"),menu_open:!1}),this.fire("change",e,{selected_line:e.get()}),this.find("button.dropdown-toggle").focus()},set_active:function(e){this.set("active_value",e.get("value"))},open_menu:function(e){var t=this.find(".droplist.btn-group"),n=this.find(".js-drop-list"),s=this.find(".js-input-container");this.set({active_value:this.get("value"),text_value:"",menu_open:!0});var i=n.offsetHeight+s.offsetHeight,r=t.getBoundingClientRect().top;window.innerHeight-t.getBoundingClientRect().top-t.offsetHeight-i<0&&r-i>0?t.classList.add("dropup"):t.classList.remove("dropup"),this.find(".js-input-container > li > input").focus(),this.find("li.selected")&&(n.scrollTop=this.find("li.selected").offsetTop)},toggle_menu:function(e){0==this.get("menu_open")?this.fire("open_menu",e):this.set("menu_open",!1)},change:function(){this.get("fp_event")&&this.exportFpData(this.find("input"),this.get("fp_event"))}}})}]).default});